{"version":3,"sources":["webpack://_N_E/./pages/hashtag/[tag].js","webpack://_N_E/./node_modules/next/dist/build/webpack/loaders/next-client-pages-loader.js?df23"],"names":["Hashtag","dispatch","useDispatch","tag","useRouter","query","useSelector","state","post","mainPosts","hasMorePosts","loadPostsLoading","useEffect","onScroll","window","pageYOffset","document","documentElement","clientHeight","scrollHeight","type","LOAD_HASHTAG_POSTS_REQUEST","lastId","length","id","data","addEventListener","removeEventListener","map","key","__NEXT_P","push"],"mappings":"sQA0DeA,UA7CC,WACZ,IAAMC,EAAWC,cAETC,EADOC,sBACQC,MAAfF,IACR,EAAsDG,aAAY,SAACC,GAAD,OAAWA,EAAMC,QAA3EC,EAAR,EAAQA,UAAWC,EAAnB,EAAmBA,aAAcC,EAAjC,EAAiCA,iBAoBjC,OAlBAC,qBAAU,WACN,IAAMC,EAAW,WAI8B,MAHvCC,OAAOC,YACLC,SAASC,gBAAgBC,aACzBF,SAASC,gBAAgBE,aAAe,MACtCT,IAAiBC,GACjBV,EAAS,CACLmB,KAAMC,IAA4BC,OAAM,UAAEb,EAAUA,EAAUc,OAAS,UAA/B,aAAE,EAAiCC,GAAIC,KAAMtB,MAQrG,OAFAW,OAAOY,iBAAiB,SAAUb,GAE3B,WAAQC,OAAOa,oBAAoB,SAAUd,MACrD,CAACJ,EAAUc,OAAQb,EAAcP,EAAKQ,IAGrC,EAAC,IAAD,KACKF,EAAUmB,KAAI,SAACpB,GAAD,OAAU,EAAC,IAAD,CAAUqB,IAAKrB,EAAKgB,GAAIhB,KAAMA,U,sBCtC9DM,OAAOgB,SAAWhB,OAAOgB,UAAY,IAAIC,KAAK,CAC7C,iBACA,WACE,OAAO,EAAQ,a","file":"static/chunks/pages/hashtag/[tag]-100cd5970400b7c83bb7.js","sourcesContent":["// hashtag/[tag].js \nimport { useRouter } from 'next/router';\nimport React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { END } from 'redux-saga';\n\nimport wrapper from '../../store/configureStore';\nimport AppLayout from '../../components/AppLayout';\nimport { LOAD_HASHTAG_POSTS_REQUEST } from '../../reducers/post';\nimport { LOAD_MY_INFO_REQUEST } from '../../reducers/user';\nimport PostCard from '../../components/PostCard';\nimport axios from 'axios';\n\nconst Hashtag = () => {\n    const dispatch = useDispatch();\n    const router = useRouter();\n    const { tag } = router.query;\n    const { mainPosts, hasMorePosts, loadPostsLoading } = useSelector((state) => state.post);\n\n    useEffect(() => { // 인피니티 스크롤\n        const onScroll = () => {\n            if (window.pageYOffset\n                + document.documentElement.clientHeight\n                > document.documentElement.scrollHeight - 300) {\n                if (hasMorePosts && !loadPostsLoading) {\n                    dispatch({\n                        type: LOAD_HASHTAG_POSTS_REQUEST, lastId: mainPosts[mainPosts.length - 1]?.id, data: tag,\n                    });\n                }\n            }\n        };\n\n        window.addEventListener('scroll', onScroll);\n\n        return () => { window.removeEventListener('scroll', onScroll); };\n    }, [mainPosts.length, hasMorePosts, tag, loadPostsLoading]);\n\n    return (\n        <AppLayout>\n            {mainPosts.map((post) => <PostCard key={post.id} post={post} />)}\n        </AppLayout>\n    );\n};\n\nexport const getServerSideProps = wrapper.getServerSideProps(async (context) => {\n    console.log('context 쿠키생성전', context);\n    const cookie = context.req ? context.req.headers.cookie : '';\n    console.log('context 쿠키생성후', context);\n    axios.defaults.headers.Cookie = '';\n    \n    if (context.req && cookie) { axios.defaults.headers.Cookie = cookie; }\n\n    context.store.dispatch({ type: LOAD_HASHTAG_POSTS_REQUEST, data: context.params.tag });\n    context.store.dispatch({ type: LOAD_MY_INFO_REQUEST });\n    context.store.dispatch(END);\n    await context.store.sagaTask.toPromise();\n});\n\nexport default Hashtag;","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/hashtag/[tag]\",\n      function () {\n        return require(\"private-next-pages/hashtag/[tag].js\");\n      }\n    ]);\n  "],"sourceRoot":""}